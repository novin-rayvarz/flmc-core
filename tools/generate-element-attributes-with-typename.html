<html>

<body>
    <h5>element type:</h5>
    <input id="input_element_type" name="input" />
    <h3>Types names ( 1 line = 1 type name ):</h3>
    <textarea id="inputTypes" multiple="true" style="width: 300px;height:300px"></textarea>
    <br />
    <button onclick="generate()">generate</button>
    <br />
    <h3>Output:</h3>
    <textarea id="output" multiple="true" style="width: 600px;height:600px"></textarea>

    <script>

        function jsLcfirst(string) {
            return string.charAt(0).toLowerCase() + string.slice(1);
        }

        function generateAttributeForTypeName(typename, elementType) {
            let lowercaseTypeName = jsLcfirst(typename);
            let containerName = `${lowercaseTypeName}Container`;
            let oFunctiuonName = `${lowercaseTypeName}O`;
            let rFunctiuonName = `${lowercaseTypeName}R`;
            return `
${containerName} = new BehaviorSubject<${typename}>([]);

private ${rFunctiuonName}(value: ${typename}): ${elementType} {
    this.${containerName}.next(value);
    return this;
}

private ${oFunctiuonName}(value: Observable<${typename}>): ${elementType} {
    value.subscribe({
        next: v => this.${containerName}.next(v),
    });
    return this;
}

${lowercaseTypeName}(value: Observable<${typename}> | ${typename}): ${elementType} {
    if (isObservable(value)) this.${oFunctiuonName}(value);
    else this.${rFunctiuonName}(value);
    return this;
}
`
        }

        let elementTypeDOM = document.getElementById("input_element_type");
        let TypeNamesDOM = document.getElementById("inputTypes");
        let outputDOM = document.getElementById("output");

        function generate() {

            let codeBlocks = [];

            for (let line of TypeNamesDOM.value.trim().split("\n"))
                codeBlocks.push(generateAttributeForTypeName(line, elementTypeDOM.value.trim()));

            outputDOM.value = codeBlocks.join("\n");


        }


    </script>

</body>

</html>